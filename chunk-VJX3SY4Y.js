import{a as A,b as c,c as M,d as R,e as B,f as m,g as U,h as L,i as z,j as J,n as K}from"./chunk-A25HTZXZ.js";import{a as f}from"./chunk-LGQEV6BK.js";import{l as j,m as H}from"./chunk-MJ7E4EBO.js";import{$ as x,Ha as u,Hb as a,Ib as q,Jb as w,Na as T,P as D,Sa as O,T as F,U as N,_ as v,a as I,b as h,ga as G,ib as p,jb as b,kb as V,lb as $,mb as k,nb as C,ob as o,pb as r,qa as P,qb as S,wb as E,yb as _,zb as d}from"./chunk-DCIY6CH7.js";var y=class i{constructor(e){this._HttpClient=e}getBills(e){return this._HttpClient.get(`${f.apiUrl}/sales?userId=${e}`)}addBill(e){return this._HttpClient.post(`${f.apiUrl}/sales`,e)}editBill(e,t){return this._HttpClient.put(`${f.apiUrl}/sales/${e}`,t)}deleteBill(e){return this._HttpClient.delete(`${f.apiUrl}/sales/${e}`)}static \u0275fac=function(t){return new(t||i)(F(H))};static \u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"})};function Y(i,e){i&1&&(o(0,"p",6),a(1,"*Product Name Is Empty"),r())}function Z(i,e){i&1&&(o(0,"p",6),a(1,"*Price Is Empty"),r())}function ee(i,e){i&1&&(o(0,"p",6),a(1,"*Count Is Empty"),r())}function te(i,e){if(i&1){let t=E();o(0,"div",15),S(1,"input",17)(2,"input",18)(3,"input",19),o(4,"button",20),_("click",function(){v(t);let l=d().$implicit,s=d();return x(s.editInAPI(l.id))}),a(5,"Submit"),r()()}if(i&2){let t=d(2);C("formGroup",t.editForm)}}function ie(i,e){if(i&1){let t=E();o(0,"div",16)(1,"h2"),a(2),r(),o(3,"h3"),a(4),r(),o(5,"p"),a(6),r(),o(7,"div",21)(8,"button",22),_("click",function(){v(t);let l=d().$implicit,s=d();return x(s.editBill(l))}),a(9,"Edit"),r(),o(10,"button",23),_("click",function(){v(t);let l=d().$implicit,s=d();return x(s.deleteBill(l.id))}),a(11,"Delete"),r()()()}if(i&2){let t=d().$implicit;u(2),q(t.name),u(2),w("Price: ",t.price),u(2),w("Count: ",t.count)}}function ne(i,e){if(i&1&&(o(0,"div",13)(1,"div",14),p(2,te,6,1,"div",15)(3,ie,12,3,"div",16),r()()),i&2){let t=e.$implicit,n=d();u(2),b(n.editingBillID===t.id?2:3)}}var Q=class i{constructor(e){this._SalesService=e}userID="";_PLATFORM_ID=N(P);billData=G([]);editingBillID=null;inputGroup=new B({name:new m(null,[c.required]),price:new m(null,[c.required]),count:new m(null,[c.required])});editForm=new B({name:new m(null,[c.required]),price:new m(null,[c.required]),count:new m(null,[c.required])});getSalesSub;addSalesSub;editSalesSub;deleteSalesSub;addBill(){let e=h(I({},this.inputGroup.value),{userId:this.userID});this.addSalesSub=this._SalesService.addBill(e).subscribe({next:t=>{console.log(t),this.billData.update(n=>[...n,t]),this.inputGroup.reset()},error:t=>{console.log(t)}})}editBill(e){console.log(e),this.editingBillID=e.id,this.editForm.setValue({name:e.name,price:e.price,count:e.count})}editInAPI(e){let t=h(I({},this.editForm.value),{id:e,userId:this.userID});this.editSalesSub=this._SalesService.editBill(e,t).subscribe({next:n=>{this.billData.update(l=>l.map(s=>s.id===e?n:s)),this.editingBillID=null}})}deleteBill(e){this.deleteSalesSub=this._SalesService.deleteBill(e).subscribe({next:t=>{this.billData.update(n=>n.filter(l=>l.id!==e))}})}ngOnInit(){j(this._PLATFORM_ID)&&(this.userID=sessionStorage.getItem("userID")?.toString()),this.getSalesSub=this._SalesService.getBills(this.userID).subscribe({next:e=>{this.billData.set(e)},error:e=>{console.log(e)}})}ngOnDestroy(){this.getSalesSub?.unsubscribe(),this.addSalesSub?.unsubscribe(),this.editSalesSub?.unsubscribe(),this.deleteSalesSub?.unsubscribe()}static \u0275fac=function(t){return new(t||i)(T(y))};static \u0275cmp=O({type:i,selectors:[["app-sales"]],decls:23,vars:5,consts:[[1,"py-5"],[1,"container"],[3,"ngSubmit","formGroup"],[1,"mb-3","border-bottom","border-3","pb-3"],["for","productName",1,"form-label"],["formControlName","name","type","text","id","productName","aria-describedby","Product Name Input",1,"form-control"],[1,"fw-semibold","bg-warning","text-danger","mt-2","rounded-2","p-1"],["for","price",1,"form-label"],["formControlName","price","type","number","id","price","aria-describedby","Product Price Input",1,"form-control"],["for","count",1,"form-label"],["formControlName","count","type","number","id","count","aria-describedby","Product Count Input",1,"form-control"],["type","submit",1,"btn","subButt",3,"disabled"],[1,"row","outContainer","py-2","my-3","rounded-3","gy-5"],[1,"col-md-3"],[1,"box","text-center","rounded-2","px-2","py-3"],[1,"form",3,"formGroup"],[1,"data"],["formControlName","name","type","text","id","productName","aria-describedby","Product Name Edit Input",1,"form-control","my-2"],["formControlName","price","type","number","id","price","aria-describedby","Product Price Edit Input",1,"form-control","my-2"],["formControlName","count","type","number","id","count","aria-describedby","Product Count Edit Input",1,"form-control","my-2"],["type","submit",1,"subButt","btn",3,"click"],[1,"buttons","d-flex","justify-content-between"],[1,"bg-warning","text-white","btn",3,"click"],[1,"bg-danger","text-white","btn",3,"click"]],template:function(t,n){if(t&1&&(o(0,"section",0)(1,"div",1)(2,"form",2),_("ngSubmit",function(){return n.addBill()}),o(3,"div",3)(4,"label",4),a(5,"Product Name:"),r(),S(6,"input",5),p(7,Y,2,0,"p",6),r(),o(8,"div",3)(9,"label",7),a(10,"Total Price:"),r(),S(11,"input",8),p(12,Z,2,0,"p",6),r(),o(13,"div",3)(14,"label",9),a(15,"Count:"),r(),S(16,"input",10),p(17,ee,2,0,"p",6),r(),o(18,"button",11),a(19,"Submit"),r()(),o(20,"div",12),$(21,ne,4,1,"div",13,V),r()()()),t&2){let l,s,g;u(2),C("formGroup",n.inputGroup),u(5),b((l=n.inputGroup.get("name"))!=null&&l.getError("required")&&((l=n.inputGroup.get("name"))!=null&&l.touched)?7:-1),u(5),b((s=n.inputGroup.get("price"))!=null&&s.getError("required")&&((s=n.inputGroup.get("price"))!=null&&s.touched)?12:-1),u(5),b((g=n.inputGroup.get("count"))!=null&&g.getError("required")&&((g=n.inputGroup.get("count"))!=null&&g.touched)?17:-1),u(),C("disabled",n.inputGroup.invalid),u(3),k(n.billData())}},dependencies:[K,U,A,L,M,R,z,J],encapsulation:2})};export{Q as Sales};
