import{c as x}from"./chunk-S3Z7IGZ6.js";import{a as u}from"./chunk-LGQEV6BK.js";import{l as b,m as I}from"./chunk-MJ7E4EBO.js";import{Ha as l,Hb as o,Ib as p,P as g,Sa as h,T as D,U as c,ga as n,ib as f,jb as v,nb as y,ob as s,pb as i,qa as d,qb as S,zb as C}from"./chunk-DCIY6CH7.js";var m=class r{constructor(e){this._HttpClient=e}getProducts(e){return this._HttpClient.get(`${u.apiUrl}/products?userId=${e}`)}getEmployees(e){return this._HttpClient.get(`${u.apiUrl}/employees?userId=${e}`)}getSales(e){return this._HttpClient.get(`${u.apiUrl}/sales?userId=${e}`)}static \u0275fac=function(t){return new(t||r)(D(I))};static \u0275prov=g({token:r,factory:r.\u0275fac,providedIn:"root"})};function P(r,e){if(r&1&&S(0,"canvas",6),r&2){let t=C();y("data",t.productSalesData())("type","bar")}}var O=class r{PLATFORM_ID=c(d);_DashService=c(m);_PLATFORM_ID=c(d);isBrowser=!1;constructor(){this.isBrowser=b(this._PLATFORM_ID)}userName="";userID="";productsData=n([]);employeeData=n([]);salesData=n([]);getProductSub;getEmployeesSub;getSalesSub;productSalesData=n({labels:[],datasets:[{label:"Number of Products per Category",data:[],backgroundColor:"rgba(2, 231, 59, 0.5)"}]});ngOnInit(){b(this.PLATFORM_ID)&&(this.userName=sessionStorage.getItem("userName")||"",this.userID=sessionStorage.getItem("userID")||""),this.getProductSub=this._DashService.getProducts(this.userID).subscribe({next:e=>{this.productsData.set(e),this.prepareChartData()},error:e=>{console.error(e)}}),this._DashService.getEmployees(this.userID).subscribe({next:e=>this.employeeData.set(e),error:e=>console.log(e)}),this.getSalesSub=this._DashService.getSales(this.userID).subscribe({next:e=>this.salesData.set(e),error:e=>console.log(e)})}prepareChartData(){let e={};for(let t of this.productsData()){let a=t.productCategory;a&&(e[a]=(e[a]||0)+1)}this.productSalesData.set({labels:Object.keys(e),datasets:[{label:"Number of Products per Category",data:Object.values(e),backgroundColor:"rgba(2, 231, 59, 0.5)"}]})}ngOnDestroy(){this.getProductSub?.unsubscribe(),this.getEmployeesSub?.unsubscribe(),this.getSalesSub?.unsubscribe()}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=h({type:r,selectors:[["app-dashboard"]],decls:20,vars:4,consts:[[1,"py-4"],[1,"container"],[1,"text-main"],[1,"data","py-5"],[1,"products","mt-4","w-75","mx-auto"],[1,"text-center","mb-2"],["baseChart","",3,"data","type"],[1,"anotherData","d-flex","justify-content-around","mt-3"],[1,"fs-5","border-bottom","border-3","pb-3"]],template:function(t,a){t&1&&(s(0,"section",0)(1,"div",1)(2,"h1"),o(3,"Hello "),s(4,"span",2),o(5),i()(),s(6,"div",3)(7,"div",4)(8,"h3",5),o(9,"Product Details"),i(),f(10,P,1,2,"canvas",6),i(),s(11,"div",7)(12,"p",8),o(13,"Number Of Employees "),s(14,"span",2),o(15),i()(),s(16,"p",8),o(17,"Number Of Bills "),s(18,"span",2),o(19),i()()()()()()),t&2&&(l(5),p(a.userName),l(5),v(a.isBrowser?10:-1),l(5),p(a.employeeData().length),l(4),p(a.salesData().length))},dependencies:[x],encapsulation:2})};export{O as Dashboard};
